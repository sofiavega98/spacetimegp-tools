% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_model.R
\name{fit_model}
\alias{fit_model}
\title{Fit Spatiotemporal Gaussian Process Model}
\usage{
fit_model(
  data,
  kernel,
  outcome_type,
  trt_counties = c(1, 2, 3),
  chains = 1,
  iter = 1000,
  warmup = 500,
  seed = 300,
  init_r = 0.1
)
}
\arguments{
\item{data}{Data frame containing the simulated data (output from simulate_data)}

\item{kernel}{Character. Type of kernel to use for modeling:
- "ICM": Intrinsic Coregionalization Model
- "sep": Separable spatiotemporal kernel
- "nonsep": Non-separable spatiotemporal kernel}

\item{outcome_type}{Character. Type of outcome distribution:
- "poisson": Poisson distribution with log link
- "normal": Normal distribution with identity link}

\item{trt_counties}{Vector of county IDs that received treatment (default: c(1, 2, 3))}

\item{chains}{Integer. Number of MCMC chains (default: 1)}

\item{iter}{Integer. Number of iterations per chain (default: 1000)}

\item{warmup}{Integer. Number of warmup iterations (default: 500)}

\item{seed}{Integer. Random seed for Stan sampling (default: 300)}

\item{init_r}{Numeric. Initialization parameter for Stan (default: 0.1)}
}
\value{
A fitted Stan model object
}
\description{
This function fits a spatiotemporal Gaussian Process model using Stan based on the specified
kernel type and outcome distribution. It automatically selects the appropriate Stan model
and data formatting function.
}
\examples{
# Simulate data first
sim_data <- simulate_data(kernel = "sep", seed = 1, distribution = "poisson")

# Fit separable Poisson model
fit <- fit_model(data = sim_data, kernel = "sep", outcome_type = "poisson")

# Fit nonseparable Normal model
fit <- fit_model(data = sim_data, kernel = "nonsep", outcome_type = "normal")

}
